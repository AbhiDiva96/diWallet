(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{321:function(e,t,a){Promise.resolve().then(a.bind(a,5681))},5681:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var n=a(7437),s=a(2265),r=a(3464),i=a(605),o=a(9376),l=a(3470),c=a(2765),d=(0,c.Z)((0,n.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),u=(0,c.Z)([(0,n.jsx)("path",{d:"M19 19c0 .55-.45 1-1 1s-1-.45-1-1v-3H8V5h11z",opacity:".3"},"0"),(0,n.jsx)("path",{d:"M19.5 3.5 18 2l-1.5 1.5L15 2l-1.5 1.5L12 2l-1.5 1.5L9 2 7.5 3.5 6 2v14H3v3c0 1.66 1.34 3 3 3h12c1.66 0 3-1.34 3-3V2zM19 19c0 .55-.45 1-1 1s-1-.45-1-1v-3H8V5h11z"},"1"),(0,n.jsx)("path",{d:"M9 7h6v2H9zm7 0h2v2h-2zm-7 3h6v2H9zm7 0h2v2h-2z"},"2")],"ReceiptLongTwoTone");let x=()=>{let[e,t]=(0,s.useState)(!1),[a,o]=(0,s.useState)([]),[l,c]=(0,s.useState)(!1),[x,m]=(0,s.useState)(null),{status:h,data:g}=(0,i.useSession)(),p=()=>t(!e);return(0,s.useEffect)(()=>{(async()=>{if("authenticated"===h){c(!0),m(null);try{let e=await r.Z.get("/api/transactions/history");o(e.data.accountHistory)}catch(e){console.error("Failed to fetch transaction history:",e),m("Failed to load transaction history. Please try again.")}finally{c(!1)}}})()},[h,g]),(0,n.jsxs)("div",{className:"relative  flex items-center justify-center pb-4",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("button",{onClick:p,className:"p-4 dark:bg-gray-800 border border-slate-400/20 rounded dark:text-white ",children:(0,n.jsx)(u,{})}),(0,n.jsx)("span",{className:"flex justify-center dark:text-white ",children:"History"})]}),e&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg w-full max-w-md mx-auto relative",children:[(0,n.jsx)("button",{onClick:p,className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700","aria-label":"Close popup",children:(0,n.jsx)(d,{className:"h-6 w-6"})}),(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)("h2",{className:"text-2xl dark:text-white font-bold mb-4",children:"Transaction History"}),(0,n.jsx)("div",{className:"overflow-y-auto max-h-[70vh]",children:l?(0,n.jsx)("p",{className:"text-center dark:text-gray-300",children:"Loading transactions..."}):x?(0,n.jsx)("p",{className:"text-center text-red-500 dark:text-red-400",children:x}):0===a.length?(0,n.jsx)("p",{className:"text-center dark:text-gray-300",children:"No transactions found."}):(0,n.jsx)("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:a.slice(0).reverse().map(e=>(0,n.jsx)("li",{className:"py-4 px-2",children:(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("div",{className:"",children:[(0,n.jsx)("p",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e.transactionName}),(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:new Date(e.createdAt).toLocaleString()})]}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("p",{className:"text-sm font-semibold ".concat("income"===e.type?"text-green-500":"text-red-500"),children:"income"===e.type?"+₹".concat(e.amount.toFixed(2)):"-₹".concat(e.amount.toFixed(2))})})]})},e.id))})})]})]})})]})};function m(){let[e,t]=(0,s.useState)({amount:0,name:"",type:""}),[a,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(null),{data:g,status:p}=(0,i.useSession)(),f=(0,o.useRouter)(),{totalAmount:b,setTotalAmount:y}=(0,l.E)();(0,s.useEffect)(()=>{"unauthenticated"===p&&f.push("/signin")},[p,f]);let j=e=>{t(t=>({...t,type:e}))},v=e=>{let{name:a,value:n}=e.target;t(e=>({...e,[a]:"amount"===a?Number(n):n}))},N=async a=>{a.preventDefault(),c(!0),u(null),h(null);try{let a=await r.Z.post("/api",e);if(200===a.status){h(a.data.message);let t="income"===e.type?e.amount:-e.amount;y(e=>e+t)}t({amount:0,name:"",type:""})}catch(e){var n,s;u((null===(s=e.response)||void 0===s?void 0:null===(n=s.data)||void 0===n?void 0:n.message)||"An error occurred"),t({amount:0,name:"",type:""})}finally{c(!1)}};return"loading"===p?(0,n.jsx)("div",{children:"Loading..."}):g?(0,n.jsxs)("div",{className:"flex flex-col items-center dark:bg-gray-900 justify-center min-h-screen bg-gray-100",children:[(0,n.jsx)(x,{}),(0,n.jsxs)("div",{className:"dark:bg-slate-800/20 shadow-lg rounded-lg p-6 w-full max-w-md mb-8 text-center",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-700 dark:text-white",children:"Total Wallet Amount"}),(0,n.jsx)("p",{className:"text-3xl ".concat(b<0?"text-red-500":"text-green-500"," font-bold mt-2"),children:"₹".concat(b)})]}),(0,n.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-8 w-full max-w-md dark:bg-gray-700/20",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-center text-gray-700 dark:text-white mb-6",children:"Add Transaction"}),d&&(0,n.jsx)("p",{className:"text-red-500 text-center mb-4",children:d}),m&&(0,n.jsx)("p",{className:"text-center mb-4 ".concat("income"===e.type?"text-green-500":"text-orange-500"),children:m}),(0,n.jsxs)("form",{onSubmit:N,children:[(0,n.jsx)("div",{className:"flex justify-center mb-4",children:(0,n.jsx)("input",{type:"number",id:"amount",name:"amount",placeholder:"Enter Amount",value:0===e.amount?"":e.amount,onChange:v,className:"mt-1 block dark:text-white px-4 py-2 bg-transparent border-b border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500 appearance-none custom-number-input",required:!0})}),(0,n.jsx)("div",{className:"flex justify-center mb-4",children:(0,n.jsx)("input",{type:"text",id:"name",name:"name",placeholder:"Transation name",value:e.name,onChange:v,className:"mt-1 block dark:text-white bg-transparent px-4 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500",required:!0})}),(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"flex justify-center gap-4 py-4",children:[(0,n.jsx)("button",{type:"button",onClick:()=>j("income"),className:"flex px-4 py-2 rounded-md focus:outline-none ".concat("income"===e.type?"bg-green-500 text-white":"border border-green-500 bg-green-400/20 text-green-500"),children:"Income"}),(0,n.jsx)("button",{type:"button",onClick:()=>j("expense"),className:"flex px-4 py-2 rounded-md focus:outline-none ".concat("expense"===e.type?"bg-red-500 text-white":"border border-orange-500 bg-orange-400/20 text-orange-500"),children:"Expense"})]})}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("button",{type:"submit",disabled:a,className:"w-64 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-500 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:a?"Adding...":"Add Transaction"})})]})]})]}):null}},3470:function(e,t,a){"use strict";a.d(t,{E:function(){return l},TotalAmountProvider:function(){return c}});var n=a(7437),s=a(3464),r=a(605),i=a(2265);let o=(0,i.createContext)(void 0),l=()=>{let e=(0,i.useContext)(o);if(void 0===e)throw Error("useTotalAmount must be used within a TotalAmountProvider");return e},c=e=>{let{children:t}=e,[a,l]=(0,i.useState)(0),{data:c,status:d}=(0,r.useSession)();(0,i.useEffect)(()=>{(async()=>{try{let e=await s.Z.get("/api/transactions");setTimeout(()=>{l(e.data.totalTransations)},1e3)}catch(e){console.error()}})()},[c,d]);let u=i.useMemo(()=>({totalAmount:a,setTotalAmount:l}),[a]);return(0,n.jsx)(o.Provider,{value:u,children:t})}}},function(e){e.O(0,[301,605,765,971,117,744],function(){return e(e.s=321)}),_N_E=e.O()}]);